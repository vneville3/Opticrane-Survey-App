<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="opticrane-icon-192.png" />
  <link rel="manifest" href="manifest.json" />
  <title>Opticrane Visual Aid Survey Collection App v1.2.0</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="app.js"></script>
</head>
<body>
<header>
  <h1>Opticrane Visual Aid Survey Collection App <span class="tag">v1.2.0</span></h1>
  <p class="subtitle">Fast, offline-ready, iPhone-friendly. Save drafts, add photos, and sync when online.</p>
</header>

<main>
  <section class="card">
    <h2>Contact</h2>
    <label>Name
      <input id="contactName" type="text" autocomplete="name" required placeholder="First Last" />
    </label>
    <label>Role or Title
      <select id="role" required>
        <option value="">Select…</option>
        <option>Owner / GM</option>
        <option>Operations Manager</option>
        <option>Site Supervisor</option>
        <option>HSE / CSO</option>
        <option>Fleet / Service</option>
        <option>Operator</option>
        <option>Other</option>
      </select>
    </label>
  </section>

  <section class="card">
    <h2>Site Location</h2>
    <label>Project Name and Address
      <input id="siteCity" type="text" required placeholder="Project Alpha — 123 Main St, Vancouver, BC" />
    </label>
    <label>Environment
      <select id="environment" required>
        <option value="">Select…</option>
        <option>High-rise construction</option>
        <option>Industrial</option>
        <option>Civil / Infrastructure</option>
        <option>Ports / Marine</option>
        <option>Warehouse &amp; MHE</option>
        <option>Other</option>
      </select>
    </label>
  </section>

  <section class="card">
    <h2>Type of Machine</h2>
    <label>Type
      <select id="machine" required>
        <option value="">Select…</option>
        <option>Tower crane</option>
        <option>Luffer</option>
        <option>PTZ (Supervisor Cam)</option>
        <option>Forklift/Telehandler</option>
        <option>Excavator</option>
        <option>Other</option>
      </select>
    </label>
    <label>Proposed Camera Kit
      <input id="targetView" type="text" placeholder="LoadView (AF-Zoom + monitor), FAMOS blind-spot, etc." />
    </label>
  </section>

  <section class="card">
    <h2>Current Issues or Concerns</h2>
    <label>How often is visibility a concern?
      <select id="impactFreq" required>
        <option value="">Select…</option>
        <option>Daily</option>
        <option>Weekly</option>
        <option>Monthly</option>
      </select>
    </label>
    <label>Time lost per shift
      <select id="timeLost" required>
        <option value="">Select…</option>
        <option>&lt; 10 minutes</option>
        <option>10–30 minutes</option>
        <option>30–60 minutes</option>
        <option>&gt; 60 minutes</option>
      </select>
    </label>
  </section>

  <section class="card">
    <h2>Level of Urgency</h2>
    <label>When are cameras needed?
      <select id="timeline" required>
        <option value="">Select…</option>
        <option>ASAP</option>
        <option>This week</option>
        <option>Later, during current project</option>
        <option>On next project (1–3 months)</option>
        <option>Never</option>
      </select>
    </label>
  </section>

  <section class="card">
    <h2>Specific Reason</h2>
    <label>Main reason (choose one)
      <select id="reason" required>
        <option value="">Select…</option>
        <option>Blind Lifts</option>
        <option>Safety (avoid near misses)</option>
        <option>Faster cycles (productivity)</option>
        <option>Better load alignment</option>
        <option>Night / low-light operations</option>
        <option>Weather challenges (rain / fog)</option>
        <option>Operator confidence (new operator)</option>
        <option>GC / client requirement</option>
      </select>
    </label>
    <label>Optional note
      <input id="reasonNote" type="text" placeholder="One-liner (optional)" />
    </label>
  </section>

  <section class="card">
    <h2>Photos (optional)</h2>
    <p>Snap up to 3 images (problem area + likely mount point). Images are compressed on device.</p>
    <input id="photos" type="file" accept="image/*" capture="environment" multiple />
    <div id="preview" class="preview"></div>
  </section>

  <section class="card">
    <h2>Rep details (optional)</h2>
    <label>Tech initials
      <input id="techInitials" type="text" maxlength="4" placeholder="VN" />
    </label>
  </section>

  <section class="actions">
    <button id="saveDraft" type="button">Save Draft</button>
    <button id="submit" type="button" class="primary">Queue Submission</button>
    <button id="helpBtn" type="button" class="ghost">Help / Info</button>
  </section>

  <section class="card">
    <h2>Sync &amp; Settings</h2>
    <div class="grid">
      <label>Endpoint URL (HTTPS)
        <input id="endpointUrl" type="url" placeholder="https://your-endpoint.example.com/ingest" inputmode="url" />
      </label>
      <label>Auth Header (optional, e.g., Authorization: Bearer …)
        <input id="authHeaderKey" type="text" placeholder="Authorization" />
      </label>
      <label>Auth Value
        <input id="authHeaderValue" type="text" placeholder="Bearer YOUR_TOKEN" />
      </label>
    </div>
    <div class="actions">
      <button id="saveSettings" type="button">Save Settings</button>
      <button id="syncNow" type="button" class="primary">Sync Now</button>
      <button id="exportJson" type="button">Export JSON</button>
      <button id="exportCsv" type="button">Export CSV</button>
      <button id="clearAll" type="button" class="danger">Clear Local Data</button>
    </div>
    <p class="fineprint">Data is stored locally on this device until you sync. Only capture business contact details. Ensure you have consent to store/send this information.</p>
  </section>

  <!-- Help Modal -->
  <div id="helpModal" class="modal" aria-hidden="true">
    <div class="modal-content">
      <button id="closeHelp" class="close" aria-label="Close">×</button>
      <h2>How this app works</h2>
      <ol>
        <li><strong>Add to Home Screen (iPhone):</strong> Open in Safari → Share → Add to Home Screen.</li>
        <li><strong>Fill on site:</strong> Contact, Site Location, Type of Machine, Current Issues or Concerns, Level of Urgency, Specific Reason.</li>
        <li><strong>Photos:</strong> Up to 3, compressed on-device.</li>
        <li><strong>Queue Submission:</strong> Saves locally for offline use.</li>
        <li><strong>Sync:</strong> Set Endpoint + Authorization header if needed → <em>Sync Now</em>.</li>
        <li><strong>Where files live:</strong> Drafts/queue are local; use <em>Export CSV/JSON</em> for backup.</li>
        <li><strong>Send to database:</strong> Endpoint can be Apps Script, Power Automate HTTP, or any HTTPS webhook.</li>
      </ol>
      <p class="fineprint">Tip: If the app updates, pull-to-refresh; the offline cache auto-updates when the service worker changes.</p>
    </div>
  </div>

</main>

<footer>
  <p>Opticrane • <a href="https://www.opticrane.com" target="_blank" rel="noopener">opticrane.com</a></p>
</footer>
</body>
</html>
